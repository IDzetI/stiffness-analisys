l1 = .75; % link 1
l2 = l1; % link 2
lp = .1; % platform

p = zeros(3);
p(:,1) = [lp 0 0]';
p(:,2) = Rz(pi/6) * p(:,1);
p(:,3) = Rz(-pi/6) * p(:,1);


K_a = 10^6;
E = 69;
L = l1;
r = .15;
S = 2*pi*r^2;
m = L*S*2700;
A = S;
I_z = 1/12*m*(3*r^2+L^2);
I_y = I_z;
I_p = m*r^2/2;
G = 26;

K11 = [
    [E*A/L  0              0            0       0            0          ]
    [0      12*E*I_z/L^3   0            0       0            6*E*I_z/L^2]
    [0      0              12*E*I_y/L^3 0       -6*E*I_y/L^2 0          ]
    [0      0              0            G*I_p/L 0            0          ]
    [0      0              -6*E*I_y/L^2 0       4*E*I_y/L  0          ]
    [0      6*E*I_z/L^2    0            0       0            4*E*I_z/L  ]
    ];

K12 = [
    [-E*A/L  0              0             0        0            0           ]
    [0       -12*E*I_z/L^3  0             0        0            -6*E*I_z/L^2]
    [0       0              -12*E*I_y/L^3 0        6*E*I_y/L^2 0           ]
    [0       0              0             -G*I_p/L 0            0           ]
    [0       0              -6*E*I_y/L^2  0        2*E*I_y/L    0           ]
    [0       6*E*I_z/L^2    0             0        0            2*E*I_z/L   ]
    ];

K21 = K12';

K22 = [
    [E*A/L  0              0            0       0            0          ]
    [0      12*E*I_z/L^3   0            0       0            -6*E*I_z/L^2]
    [0      0              12*E*I_y/L^3 0       6*E*I_y/L^2  0          ]
    [0      0              0            G*I_p/L 0            0          ]
    [0      0              6*E*I_y/L^2  0       4*E*I_y/L    0          ]
    [0      -6*E*I_z/L^2   0            0       0            4*E*I_z/L  ]
    ];

h_ex_12 = [1 0 0 0 0 0];
h_ey_12 = [0 1 0 0 0 0];
h_ez_12 = [0 0 1 0 0 0];

h_rx_12 = [
    [0 1 0 0 0 0]
    [0 0 1 0 0 0]
    [0 0 0 1 0 0]
    [0 0 0 0 1 0]
    [0 0 0 0 0 1]
    ];

h_ry_12 = [
    [1 0 0 0 0 0]
    [0 0 1 0 0 0]
    [0 0 0 1 0 0]
    [0 0 0 0 1 0]
    [0 0 0 0 0 1]
    ];

h_rz_12 = [
    [1 0 0 0 0 0]
    [0 1 0 0 0 0]
    [0 0 0 1 0 0]
    [0 0 0 0 1 0]
    [0 0 0 0 0 1]
    ];

h_px_34 = [0 0 0 1 0 0];
h_px_56 = h_px_34;
h_px_78 = h_px_34;

h_py_34 = [0 0 0 0 1 0];
h_py_56 = h_py_34;
h_py_78 = h_py_34;

h_pz_34 = [0 0 0 0 0 1];
h_pz_56 = h_pz_34;
h_pz_78 = h_pz_34;

h_rx_34 = [
    [1 0 0 0 0 0]
    [0 1 0 0 0 0]
    [0 0 1 0 0 0]
    [0 0 0 0 1 0]
    [0 0 0 0 0 1]
    ];
h_rx_56 = h_rx_34;
h_rx_78 = h_rx_34;

h_ry_34 = [
    [1 0 0 0 0 0]
    [0 1 0 0 0 0]
    [0 0 1 0 0 0]
    [0 0 0 1 0 0]
    [0 0 0 0 0 1]
    ];
h_ry_56 = h_ry_34;
h_ry_78 = h_ry_34;


h_rz_34 = [
    [1 0 0 0 0 0]
    [0 1 0 0 0 0]
    [0 0 1 0 0 0]
    [0 0 0 1 0 0]
    [0 0 0 0 1 0]
    ];
h_rz_56 = h_rz_34;
h_rz_78 = h_rz_34;
